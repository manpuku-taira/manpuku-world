<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=1, user-scalable=no" />
  <meta name="theme-color" content="#060814" />
  <title>Manpuku World</title>
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <!-- Title -->
  <section id="title" class="screen active">
    <div class="titleCard">
      <div class="titleLogo">MANPUKU WORLD</div>
      <div class="titleSub">iPhone Layout (3×4 Grid)</div>

      <div class="titleBtns">
        <button id="btnStart" class="btn primary" type="button">START</button>
        <button id="btnSettingsOpen" class="btn" type="button">設定</button>
        <button id="btnHelpOpen" class="btn" type="button">ルール</button>
      </div>

      <div id="boot" class="boot">読み込み中…</div>
    </div>
  </section>

  <!-- Game -->
  <section id="game" class="screen">
    <header class="hud">
      <div class="hudLeft">
        <div class="chip" id="chipTurn">TURN 1</div>
        <div class="chip" id="chipPhase">START</div>
      </div>
      <div class="hudMid">
        <div class="chip active" id="chipActive">YOUR TURN</div>
        <div class="firstInfo" id="firstInfo"></div>
      </div>
      <div class="hudRight">
        <button id="btnLog" class="hudBtn" type="button">LOG</button>
        <button id="btnHelp" class="hudBtn" type="button">HELP</button>
        <button id="btnSettings" class="hudBtn" type="button">SET</button>
      </div>
    </header>

    <!-- fixed board area (no auto-start by scroll) -->
    <main class="stage">
      <!-- Field underlay -->
      <img id="fieldImg" class="fieldImg" alt="" />

      <!-- ENEMY: Character -> Effect -> Shield -> EnemyHand -->
      <section class="side enemy">
        <div class="rowTitle">
          <div class="rowName">ENEMY</div>
          <div class="miniCounts">
            <span>DECK <b id="aiDeckN">0</b></span>
            <span>WING <b id="aiWingN">0</b></span>
            <span>OUT <b id="aiOutN">0</b></span>
          </div>
        </div>

        <!-- 3×4 grid -->
        <div class="grid34">
          <!-- Row 1: Character + OUT -->
          <div class="label">CHAR</div>
          <div class="grid3" id="aiC"></div>
          <button class="pileBtn smallPile" id="aiOutBtn" type="button">
            <div class="pileFace" id="aiOutFace"></div>
            <div class="pileCap">OUT</div>
          </button>

          <!-- Row 2: Effect + WING -->
          <div class="label">EFFECT</div>
          <div class="grid3" id="aiE"></div>
          <button class="pileBtn smallPile" id="aiWingBtn" type="button">
            <div class="pileFace" id="aiWingFace"></div>
            <div class="pileCap">WING</div>
          </button>

          <!-- Row 3: Shield + DECK -->
          <div class="label">SHIELD</div>
          <div class="grid3 small" id="aiS"></div>
          <button class="pileBtn smallPile" id="aiDeckBtn" type="button">
            <div class="pileFace back" id="aiDeckFace"></div>
            <div class="pileCap">DECK</div>
          </button>
        </div>

        <!-- Enemy hand (comes after Shield) -->
        <div class="handLine">
          <div class="handLineLabel" id="enemyHandLabel">ENEMY HAND ×0</div>
          <div class="enemyHand" id="aiHand"></div>
        </div>
      </section>

      <div class="divider"></div>

      <!-- YOU: Character -> Effect -> Shield -> Hand -->
      <section class="side you">
        <div class="rowTitle">
          <div class="rowName">YOU</div>
          <div class="miniCounts">
            <span>DECK <b id="pDeckN">0</b></span>
            <span>WING <b id="pWingN">0</b></span>
            <span>OUT <b id="pOutN">0</b></span>
          </div>
        </div>

        <div class="grid34">
          <!-- Row 1: Character + OUT -->
          <div class="label">CHAR</div>
          <div class="grid3" id="pC"></div>
          <button class="pileBtn smallPile" id="pOutBtn" type="button">
            <div class="pileFace" id="pOutFace"></div>
            <div class="pileCap">OUT</div>
          </button>

          <!-- Row 2: Effect + WING -->
          <div class="label">EFFECT</div>
          <div class="grid3" id="pE"></div>
          <button class="pileBtn smallPile" id="pWingBtn" type="button">
            <div class="pileFace" id="pWingFace"></div>
            <div class="pileCap">WING</div>
          </button>

          <!-- Row 3: Shield + DECK -->
          <div class="label">SHIELD</div>
          <div class="grid3 small" id="pS"></div>
          <button class="pileBtn smallPile" id="pDeckBtn" type="button">
            <div class="pileFace back" id="pDeckFace"></div>
            <div class="pileCap">DECK</div>
          </button>
        </div>

        <!-- Player hand (after Shield) -->
        <div class="handWrap">
          <div class="handHint">HAND（タップ=選択 / 長押し=詳細）</div>
          <div class="hand" id="hand"></div>
        </div>

        <div class="actions">
          <div class="announce" id="announce">準備中…</div>
          <button id="btnNext" class="btn primary" type="button">NEXT</button>
          <button id="btnEnd" class="btn danger" type="button">END</button>
        </div>
      </section>
    </main>
  </section>

  <!-- Modals -->
  <div class="modal" id="viewerM">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle" id="viewerTitle">CARD</div>
        <button class="x" data-close="viewer" type="button">×</button>
      </div>
      <div class="modalBody">
        <img id="viewerImg" class="viewerImg" alt="" />
        <pre id="viewerText" class="viewerText"></pre>
      </div>
    </div>
  </div>

  <div class="modal" id="zoneM">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle" id="zoneTitle">ZONE</div>
        <button class="x" data-close="zone" type="button">×</button>
      </div>
      <div class="modalBody">
        <div id="zoneList" class="zoneList"></div>
      </div>
    </div>
  </div>

  <div class="modal" id="confirmM">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle" id="confirmTitle">確認</div>
        <button class="x" data-close="confirm" type="button">×</button>
      </div>
      <div class="modalBody">
        <div id="confirmBody" class="confirmBody"></div>
        <div class="confirmBtns">
          <button id="btnNo" class="btn" type="button">キャンセル</button>
          <button id="btnYes" class="btn primary" type="button">OK</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" id="settingsM">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle">設定</div>
        <button class="x" data-close="settings" type="button">×</button>
      </div>
      <div class="modalBody">
        <div class="formRow">
          <div class="label2">GitHub Repo（owner/repo）</div>
          <input id="repoInput" class="input" placeholder="manpuku-taira/manpuku-world" />
        </div>
        <div class="formBtns">
          <button id="btnRepoSave" class="btn primary" type="button">保存</button>
          <button id="btnRescan" class="btn" type="button">画像再取得</button>
          <button id="btnClearCache" class="btn danger" type="button">キャッシュ削除</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" id="helpM">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle">ルール（簡易）</div>
        <button class="x" data-close="help" type="button">×</button>
      </div>
      <div class="modalBody help">
        <ul>
          <li>縦順：キャラクター → エフェクト → シールド → 手札</li>
          <li>右枠：OUT（キャラ横）/ WING（エフェクト横）/ DECK（シールド横）</li>
          <li>MAIN：手札選択→C（キャラ）またはE（発動/装備）</li>
          <li>BATTLE：自分C→相手C/シールド（相手Cが0の時のみシールド攻撃）</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="modal" id="logM">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle">LOG</div>
        <button class="x" data-close="log" type="button">×</button>
      </div>
      <div class="modalBody">
        <div id="logBody" class="logBody"></div>
      </div>
    </div>
  </div>

  <script src="./script.js"></script>
</body>
</html>