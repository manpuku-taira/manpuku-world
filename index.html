<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Manpuku World / マンプクワールド</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <!-- TITLE -->
  <section id="titleScreen" class="screen active">
    <div class="titlePanel">
      <div class="logo">
        <div class="logoMain">Manpuku World</div>
        <div class="logoSub">マンプクワールド</div>
      </div>

      <div class="titleMeta">
        <div class="pill">ダーク×サイバーファンタジー</div>
        <div class="pill">演出：派手（スキップ可）</div>
        <div class="pill">縦→横 レイアウト対応</div>
      </div>

      <button id="startBtn" class="btn primary big">画面タッチで対戦開始</button>
      <div class="small">※音が出ない場合は一度タップ後に再生が有効になります</div>
    </div>
  </section>

  <!-- GAME -->
  <section id="gameScreen" class="screen">
    <div class="topbar">
      <div class="left">
        <div id="turnChip" class="chip">TURN -</div>
        <div id="phaseChip" class="chip subtle">PHASE -</div>
        <div id="whoChip" class="chip subtle">-</div>
      </div>
      <div class="right">
        <button id="btnNextPhase" class="btn small primary">次のフェイズ</button>
        <button id="btnEndTurn" class="btn small">ターン終了</button>
        <button id="btnLog" class="btn small ghost">ログ</button>
        <button id="btnSettings" class="btn small ghost">画像/データ設定</button>
      </div>
    </div>

    <div class="boardWrap">
      <!-- whole battlefield: enemy(top) + you(bottom) -->
      <div class="battlefield" id="battlefield">
        <!-- Enemy half -->
        <div class="half enemy">
          <div class="mat layer" id="enemyMat"></div>
          <div class="grid6">
            <!-- Row 1: D S S S -->
            <div class="cell pile" id="enemyD"><div class="zTitle">D</div><div class="zCount" id="enemyDeckCount">-</div></div>
            <div class="cell shields" id="enemyS0"></div>
            <div class="cell shields" id="enemyS1"></div>
            <div class="cell shields" id="enemyS2"></div>

            <!-- Row 2: W E E E -->
            <div class="cell pile tappable" id="enemyW"><div class="zTitle">W</div><div class="zCount" id="enemyWingCount">0</div></div>
            <div class="cell zone3" id="enemyE"></div>
            <div class="cell zone3" id="enemyE2"></div>
            <div class="cell zone3" id="enemyE3"></div>

            <!-- Row 3: O C C C -->
            <div class="cell pile tappable" id="enemyO"><div class="zTitle">O</div><div class="zCount" id="enemyOutCount">0</div></div>
            <div class="cell zone3" id="enemyC"></div>
            <div class="cell zone3" id="enemyC2"></div>
            <div class="cell zone3" id="enemyC3"></div>
          </div>

          <div class="enemyHandBar">
            <div class="chip subtle">ENEMY HAND</div>
            <div id="enemyHandCount" class="chip">0</div>
          </div>
        </div>

        <!-- You half -->
        <div class="half you">
          <div class="mat layer" id="youMat"></div>
          <div class="grid6">
            <!-- Row 4: C C C O -->
            <div class="cell zone3" id="youC"></div>
            <div class="cell zone3" id="youC2"></div>
            <div class="cell zone3" id="youC3"></div>
            <div class="cell pile tappable" id="youO"><div class="zTitle">O</div><div class="zCount" id="youOutCount">0</div></div>

            <!-- Row 5: E E E W -->
            <div class="cell zone3" id="youE"></div>
            <div class="cell zone3" id="youE2"></div>
            <div class="cell zone3" id="youE3"></div>
            <div class="cell pile tappable" id="youW"><div class="zTitle">W</div><div class="zCount" id="youWingCount">0</div></div>

            <!-- Row 6: S S S D -->
            <div class="cell shields" id="youS0"></div>
            <div class="cell shields" id="youS1"></div>
            <div class="cell shields" id="youS2"></div>
            <div class="cell pile" id="youD"><div class="zTitle">D</div><div class="zCount" id="youDeckCount">-</div></div>
          </div>
        </div>

        <!-- overlay arrow -->
        <svg class="arrowLayer" id="arrowLayer"></svg>
      </div>

      <!-- Your hand (floating) -->
      <div class="handDock">
        <div class="handTitle">
          <div class="chip">HAND</div>
          <div class="chip subtle">タップ：選択 / 長押し：詳細</div>
        </div>
        <div id="handRow" class="handRow"></div>
      </div>
    </div>
  </section>

  <!-- CARD VIEWER -->
  <div id="cardModal" class="modal">
    <div class="modalBack" data-close="cardModal"></div>
    <div class="modalCard">
      <div class="modalHeader">
        <div id="cardModalTitle" class="modalTitle">CARD</div>
        <button class="btn small ghost" data-close="cardModal">閉じる</button>
      </div>
      <div class="viewerBody">
        <img id="cardModalImg" alt="" />
        <div id="cardModalText" class="viewerText"></div>
      </div>
    </div>
  </div>

  <!-- LOG -->
  <div id="logModal" class="modal">
    <div class="modalBack" data-close="logModal"></div>
    <div class="modalCard smallCard">
      <div class="modalHeader">
        <div class="modalTitle">LOG</div>
        <button class="btn small ghost" data-close="logModal">閉じる</button>
      </div>
      <div id="logBox" class="logBox"></div>
    </div>
  </div>

  <!-- SETTINGS -->
  <div id="settingsModal" class="modal">
    <div class="modalBack" data-close="settingsModal"></div>
    <div class="modalCard">
      <div class="modalHeader">
        <div class="modalTitle">画像 / データ設定</div>
        <button class="btn small ghost" data-close="settingsModal">閉じる</button>
      </div>

      <div class="settingsBody">
        <div class="settingsBlock">
          <div class="settingsTitle">フィールド画像</div>
          <div class="settingsRow">
            <input id="fieldInput" class="input" placeholder="/assets/field.jpg など" />
            <button id="saveFieldBtn" class="btn small primary">保存</button>
          </div>
          <div class="settingsHint">上半分＝相手（逆向き）／下半分＝自分（正向き）で表示します。</div>
        </div>

        <div class="settingsBlock">
          <div class="settingsTitle">カード画像（自動探索＋手動上書き）</div>
          <div class="settingsRow">
            <button id="autoScanBtn" class="btn small">画像を自動探索</button>
            <button id="openMapBtn" class="btn small ghost">画像マップ確認</button>
          </div>
          <div class="settingsHint">
            assets/cards に置いた画像を、No.01〜20として探します。<br />
            jpg/png、二重拡張子（.png.JPG / .jpg.png）も許容します。
          </div>
          <div id="mapList" class="cardMapList hidden"></div>
        </div>

        <div class="settingsBlock">
          <div class="settingsTitle">カード効果データ（貼り付けで一括反映）</div>
          <div class="settingsHint">
            ここに JSON を貼ると、カード名・効果文を一括でゲーム内に反映できます。<br />
            ※康臣さんの20枚テキストは私が次で下書きを入れます（誤読チェック用に）。
          </div>
          <textarea id="cardJsonArea" class="textarea" placeholder='例: {"01":{"name":"カード名","text":"効果文"}, ... }'></textarea>
          <div class="settingsRow bottomRow">
            <button id="loadJsonBtn" class="btn small primary">反映</button>
            <button id="exportJsonBtn" class="btn small ghost">現データを書き出し</button>
          </div>
        </div>

        <div class="settingsBlock">
          <div class="settingsTitle">裏面（仮）</div>
          <div class="settingsHint">
            まだ裏面画像が無くても、黒カードとして表示します。<br />
            裏面画像が出来たら /assets/back.jpg などで差し替え可能です。
          </div>
          <div class="settingsRow">
            <input id="backInput" class="input" placeholder="/assets/back.jpg（任意）" />
            <button id="saveBackBtn" class="btn small primary">保存</button>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script src="./script.js"></script>
</body>
</html>